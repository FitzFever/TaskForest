# TaskForest流程图说明

## 1. 任务生命周期流程

```mermaid
stateDiagram-v2
    [*] --> 创建任务
    创建任务 --> 设置DDL
    设置DDL --> 获得种子
    获得种子 --> 任务进行中
    任务进行中 --> 更新进度
    更新进度 --> 检查生命值
    检查生命值 --> 判断状态
    判断状态 --> 健康状态
    判断状态 --> 轻微枯萎
    判断状态 --> 中度枯萎
    判断状态 --> 严重枯萎
    健康状态 --> 任务进行中
    轻微枯萎 --> 任务进行中
    中度枯萎 --> 任务进行中
    严重枯萎 --> 任务进行中
    任务进行中 --> 完成任务
    任务进行中 --> 延期处理
    延期处理 --> 调整DDL
    调整DDL --> 任务进行中
    完成任务 --> 树木成熟
    树木成熟 --> [*]
```

## 2. 生命值计算流程

```mermaid
flowchart TD
    A[开始] --> B[获取任务信息]
    B --> C{是否有DDL?}
    C -->|是| D[计算剩余时间]
    C -->|否| E[设置默认DDL]
    D --> F[计算生命值]
    E --> F
    F --> G{检查任务进度}
    G -->|进度正常| H[维持生命值]
    G -->|进度落后| I[加速衰减]
    G -->|进度超前| J[恢复生命值]
    H --> K[更新树木状态]
    I --> K
    J --> K
    K --> L[结束]
```

## 3. 用户核心路径

```mermaid
sequenceDiagram
    participant U as 用户
    participant S as 系统
    participant A as AI助手
    
    U->>S: 创建新任务
    S->>U: 显示任务创建表单
    U->>S: 填写任务信息
    S->>A: 请求AI拆解(可选)
    A-->>S: 返回拆解建议
    S-->>U: 显示拆解结果
    U->>S: 确认创建
    S->>S: 生成对应种子
    S-->>U: 显示种子状态
    U->>S: 更新任务进度
    S->>S: 计算生命值
    S-->>U: 更新树木状态
    U->>S: 完成任务
    S->>S: 树木成熟
    S-->>U: 显示完成效果
```

## 4. 森林互动流程

```mermaid
graph TD
    A[进入森林界面] --> B[加载森林场景]
    B --> C[显示当前树木]
    C --> D{用户操作}
    D -->|缩放| E[调整视角]
    D -->|平移| F[移动视角]
    D -->|点击树木| G[显示任务详情]
    D -->|时间筛选| H[切换时间视图]
    E --> C
    F --> C
    G --> I[显示任务信息]
    H --> J[更新森林显示]
    I --> C
    J --> C
```

## 5. AI任务拆解流程

```mermaid
flowchart LR
    A[开始] --> B[接收复杂任务]
    B --> C[AI分析任务]
    C --> D[生成拆解建议]
    D --> E[用户确认]
    E -->|同意| F[创建子任务]
    E -->|修改| G[调整建议]
    G --> D
    F --> H[生成主树]
    H --> I[生成子任务种子]
    I --> J[开始任务追踪]
    J --> K[结束]
```

## 6. 奖励系统流程

```mermaid
stateDiagram-v2
    [*] --> 检查成就条件
    检查成就条件 --> 判断成就类型
    判断成就类型 --> 连续完成成就
    判断成就类型 --> 数量达成成就
    判断成就类型 --> 特殊解锁成就
    连续完成成就 --> 更新成就状态
    数量达成成就 --> 更新成就状态
    特殊解锁成就 --> 更新成就状态
    更新成就状态 --> 触发奖励
    触发奖励 --> 解锁新树种
    触发奖励 --> 解锁装饰物
    触发奖励 --> 显示特效
    解锁新树种 --> [*]
    解锁装饰物 --> [*]
    显示特效 --> [*]
```

## 7. 任务状态转换流程

```mermaid
stateDiagram-v2
    [*] --> 新建任务
    新建任务 --> 进行中
    进行中 --> 更新进度
    更新进度 --> 检查状态
    检查状态 --> 进行中
    检查状态 --> 延期
    检查状态 --> 完成
    延期 --> 调整DDL
    调整DDL --> 进行中
    完成 --> 已归档
    已归档 --> [*]
```

这些流程图展示了TaskForest的主要业务流程和状态转换。每个流程图都针对特定的功能模块，帮助开发团队更好地理解系统的运作方式。流程图使用mermaid语法编写，可以在支持mermaid的markdown查看器中直接渲染。

---
*本文档由产品设计师王芳负责维护，将根据产品开发进展持续更新* 