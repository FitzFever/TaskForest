# TaskForest 树木模型开发指南

## 概述

本文档提供了TaskForest项目中所有树木模型的开发指南。每个模型应参照`design`目录下的原型图，确保风格统一且符合项目美术规范。

## 目录结构

按照项目规范，树木模型应遵循以下目录结构：

```
models/
├── source/         # Blender源文件
│   └── trees/      # 树木模型源文件
│       ├── oak/    # 橡树模型
│       ├── pine/   # 松树模型
│       └── ...     # 其他树种
└── export/         # 导出的GLB文件
    └── trees/      # 树木导出模型
        ├── oak.glb
        ├── oak_seed.glb
        └── ...
```

## 模型技术规格

所有模型必须符合以下技术规格：

- **多边形数量**：每个成熟树模型不超过2000个三角面
- **纹理贴图**：512x512像素，使用PBR材质
- **文件格式**：
  - 源文件：Blender (.blend)，版本2.93或更高
  - 导出文件：glTF/GLB (.glb)
- **尺寸比例**：成熟树高度约4-6个单位，与人物模型比例协调
- **骨骼/动画**：每个生长阶段需要包含相应的骨骼，便于动画控制

## 命名规范

- **源文件**: `{tree_type}_{growth_stage}.blend`
  例如: `oak_seed.blend`, `pine_mature.blend`

- **导出文件**: `{tree_type}.glb` 或 `{tree_type}_{stage}.glb` 或 `{health_state}tree.glb`
  例如: `oak.glb`, `pine_sapling.glb`, `healthytree.glb`

## 树木品种详细规格

### 1. 橡树 (Oak)

- **参考图**：`design/橡树.png`
- **特点**：粗壮树干，宽阔树冠，叶子形状独特
- **颜色**：
  - 树干：深棕色 (#5D4037)
  - 叶子：深绿色 (#2E7D32)，秋季可变为棕红色 (#BF360C)
- **生长阶段特征**：
  - 种子：橡子，椭圆形带有帽状顶部
  - 幼苗：单茎，少量叶子
  - 成长：开始分枝，树冠扩展
  - 成熟：宽大树冠，粗壮主干，明显的树皮纹理

### 2. 松树 (Pine)

- **参考图**：`design/松树.png`
- **特点**：锥形树冠，枝干向上，针状叶
- **颜色**：
  - 树干：红褐色 (#795548)
  - 针叶：墨绿色 (#004D40)
- **生长阶段特征**：
  - 种子：松果，椭圆形带有鳞片
  - 幼苗：单茎，少量针叶
  - 成长：开始分层生长，锥形初现
  - 成熟：完美锥形，分层明显，枝干上扬

### 3. 樱花树 (Cherry)

- **参考图**：`design/樱花树.png`
- **特点**：优美弯曲的枝干，茂密的花朵
- **颜色**：
  - 树干：深灰褐色 (#5D4037)
  - 花朵：淡粉色 (#F8BBD0)至深粉色 (#EC407A)
  - 叶子：明亮绿色 (#66BB6A)（花后）
- **生长阶段特征**：
  - 种子：樱桃核，小而圆
  - 幼苗：细茎，少量嫩叶
  - 成长：开始分枝，树冠扩展
  - 成熟：开满樱花，枝干优美弯曲

### 4. 枫树 (Maple)

- **参考图**：`design/枫树.png`
- **特点**：独特的枫叶形状，秋季鲜红色叶子
- **颜色**：
  - 树干：暗灰色 (#424242)
  - 叶子：绿色 (#4CAF50)变为红色 (#D32F2F)
- **生长阶段特征**：
  - 种子：带翅螺旋状
  - 幼苗：红棕色细茎，少量枫叶
  - 成长：开始分枝，特色叶形明显
  - 成熟：茂密的枫叶树冠，美丽的秋色变化

### 5. 棕榈树 (Palm)

- **参考图**：`design/棕榈树.png`
- **特点**：高挑直立的树干，顶部扇形叶片
- **颜色**：
  - 树干：棕褐色 (#8D6E63)
  - 叶子：鲜绿色 (#388E3C)
- **生长阶段特征**：
  - 种子：椰子形状
  - 幼苗：短小单茎，几片大型叶子
  - 成长：茎干延长，叶片增多
  - 成熟：高大树干，顶部扇形叶冠

### 6. 柳树 (Willow)

- **参考图**：`design/柳树.png`
- **特点**：下垂的柔软枝条，垂帘状
- **颜色**：
  - 树干：灰褐色 (#795548)
  - 叶子：浅绿色 (#8BC34A)
- **生长阶段特征**：
  - 种子：柳絮，小而轻
  - 幼苗：直立细茎，向上生长
  - 成长：开始出现下垂枝条
  - 成熟：优美下垂的枝条，形成帘状效果

### 7. 苹果树 (Apple)

- **参考图**：`design/苹果树.png`
- **特点**：开放式树冠，花期和结果期有特殊视觉效果
- **颜色**：
  - 树干：棕灰色 (#6D4C41)
  - 叶子：中绿色 (#388E3C)
  - 花朵：浅粉色 (#F8BBD0)
  - 果实：红色 (#D32F2F)
- **生长阶段特征**：
  - 种子：苹果籽，小而扁平
  - 幼苗：细直树干，少量叶子
  - 成长：开始分枝，可能有少量花朵
  - 成熟：树冠开放，可结满红苹果

### 8. 橡胶树 (Rubber Tree)

- **参考图**：`design/稀有树种.png`中相关元素
- **特点**：光滑树干，大型椭圆形叶片
- **颜色**：
  - 树干：灰色 (#616161)
  - 叶子：深绿色有光泽 (#1B5E20)
- **生长阶段特征**：
  - 种子：小型椭圆形
  - 幼苗：直立单茎，几片大叶子
  - 成长：茎干加粗，叶片增多
  - 成熟：笔直的树干，顶部茂密的叶丛

## 健康状态表现

每种树木需要表现不同的健康状态：

### 健康 (healthy)
- 叶片饱满有光泽
- 颜色鲜艳
- 树干姿态挺拔

### 轻微枯萎 (slightly_wilted)
- 叶片略有卷曲
- 颜色稍黯淡，有10-20%变黄
- 树姿正常

### 中度枯萎 (moderately_wilted)
- 叶片明显卷曲
- 有30-50%叶片变黄或变褐
- 树干可能略有倾斜

### 严重枯萎 (severely_wilted)
- 大部分叶片卷曲或脱落
- 60%以上叶片变褐
- 树干可能明显倾斜

## Blender建模指南

### 建模步骤

1. **参考图导入**：
   - 将树木PNG图片导入为参考平面
   - 创建正视图和侧视图参考

2. **基础造型**：
   - 从简单形状开始（圆柱体、球体）
   - 使用细分曲面修改器增加细节
   - 保持拓扑结构简洁清晰

3. **树干建模**：
   - 使用曲线或多边形建模方法
   - 添加适当的树皮细节
   - 使用位移贴图增加表面细节

4. **树叶系统**：
   - 使用粒子系统或几何节点创建树叶
   - 创建基础叶片模型，然后实例化
   - 确保叶片分布自然

5. **UV展开**：
   - 树干和主要分支使用圆柱形展开
   - 叶片使用平面展开
   - 尽量减少UV接缝，放在不显眼处

6. **材质设置**：
   - 为树干创建PBR材质
   - 为叶片创建半透明材质，使用Alpha通道
   - 添加适当的凹凸和光泽贴图

7. **骨骼系统**：
   - 为动画创建简单骨架
   - 树干至少3-4根骨骼
   - 主要分支各1-2根骨骼

8. **LOD级别**：
   - 创建至少2级LOD版本
   - 低精度版本控制在500面以内

### 导出步骤

1. **GLB导出设置**：
   - 导出格式：glTF 2.0 (.glb)
   - 确保包括所有材质和纹理
   - 骨骼动画：包含
   - 变形目标：包含（如果有）

2. **文件命名**：遵循上述命名规范

3. **模型测试**：
   - 使用TaskForest模型查看器测试
   - 检查面数是否符合要求
   - 确认动画正常工作

## 进度管理

根据设计报告，当前进度：
- 橡树全生命周期（种子、幼苗、成长、成熟）已完成
- 其他7种树木的种子阶段已完成

下一步优先级：
1. 完成所有树木的幼苗阶段
2. 完成所有树木的成长阶段
3. 完成所有树木的成熟阶段
4. 为所有树木添加不同健康状态变体

## 参考资源

- [Blender官方文档](https://docs.blender.org/)
- [树木建模专业教程](https://blender.org)
- [PBR材质基础](https://blender.org)
- [Three.js glTF加载指南](https://threejs.org/docs/#examples/en/loaders/GLTFLoader)

---

*文档最后更新：2024年4月9日* 